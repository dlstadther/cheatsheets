{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Cheatsheets","text":"<p>This is the home to my cheatsheets!</p>"},{"location":"docker/","title":"Docker","text":""},{"location":"docker/#commands","title":"Commands","text":"<p>Cleanup: <pre><code># remove all unused data, including volumes\ndocker system prune --volumes\n\n# If wanting more granular cleanup...\n\n# remove dangling build caches\ndocker builder prune\n# remove stopped containers\ndocker container prune\n# remove dangling images (those named `&lt;none&gt;`)\ndocker image prune\n# remove unused networks\ndocker network prune\n# remove anonymous local unused volumes\ndocker volume prune\n</code></pre></p>"},{"location":"docker/#docker-compose","title":"Docker Compose","text":"<p>Rebuild docker compose components from scratch <pre><code>docker compose up --no-deps --build\n</code></pre></p>"},{"location":"git/","title":"Git","text":"<p>Git is a wonderful tool for source control management (scm), especially when working on multiple features as an individual or on a team.</p> <p>Personally, I don't like to get too complicated with my git commands. I prefer to know the core of git well enough to serve me for 99% of of uses. Then using Google-fu for those 1% situations.</p>"},{"location":"git/#terminology","title":"Terminology","text":"Term Description local on the harddrive of the computer running your git commands remote central scm server (i.e. Github, Gitlab, Bitbucket, etc.) origin traditional tag associated with a repo's remote commit set of file changes with a message (think of this similar to a checkpoint save) branch ... merge ... rebase ... push upload your local commits to a remote pull download remote commits to your local clone download a remote repo to your local for the first time staged local files which have been prepared to be included in the next commit (the targets of <code>git add</code>) unstaged local files which have been included in a prior commit with changes not yet ready to be committed untracked local files within a repo's directory which have never been included in a commit"},{"location":"git/#commands","title":"Commands","text":""},{"location":"git/#set-up-ssh-key-for-use-with-ssh-git-auth","title":"Set up ssh key for use with ssh git auth","text":"<pre><code>ssh-keygen -t rsa -b 4096 -C \"yourEmail@domain.com\"\n# provide optional passphrase\neval \"$(ssh-agent -s)\"\nssh-add -K ~/.ssh/id_rsa\n\n# copy public key to scm provider\n# follow their instructions for where you set in your auth profile\ncat ~/.ssh/id_rsa.pub\n</code></pre>"},{"location":"git/#start-a-new-local-repo","title":"Start a new local repo","text":"<pre><code>mkdir localRepo\ncd ./localRepo\ngit init\n</code></pre>"},{"location":"git/#pull-remote-repo-to-local-for-the-first-time","title":"Pull Remote Repo to Local (for the first time)","text":"<pre><code># assuming Github project fakerepo, owned by dlstadther\n# with ssh auth\ngit clone git@github.com:dlstadther/fakerepo.git\n\n# with https basic auth\ngit clone https://github.com/dlstadther/fakerepo.git\n\n# ssh auth with custom directory name\ngit clone git@github.com:dlstadther/fakerepo.git foobar\n</code></pre>"},{"location":"git/#update-local-references-to-remotes","title":"Update local references to remotes","text":"<pre><code>git fetch origin\n</code></pre>"},{"location":"git/#start-new-branch","title":"Start new branch","text":"<pre><code># create and checkout a new branch \"feature/my-feature\" based off local master\ngit checkout -b feature/my-feature master\n</code></pre>"},{"location":"git/#view-all-locally-tracked-branches","title":"View all locally tracked branches","text":"<pre><code>git branch -a\n</code></pre>"},{"location":"git/#change-branches","title":"Change branches","text":"<pre><code># assumes already on master, and the existence of develop\ngit checkout develop\n\n# switch back to previous branch\ngit checkout -\n</code></pre>"},{"location":"git/#update-branch-with-remote-master","title":"Update branch with remote master","text":"<pre><code># without updating local master w/o merge commit\ngit fetch origin\ngit rebase origin/master\n\n# with local update and merge commit\ngit checkout master\ngit pull origin master\ngit checkout -\ngit merge master\n</code></pre>"},{"location":"git/#update-feature-branch-with-remote","title":"Update [feature] branch with remote","text":"<pre><code># with merge commit\ngit pull origin my-branch\n\n# without merge commit\ngit pull --rebase\n</code></pre>"},{"location":"git/#rename-branch","title":"Rename branch","text":"<pre><code>git branch -m oldname newname\n\n# rename current branch\ngit branch -m newname\n</code></pre>"},{"location":"git/#add-to-last-commit","title":"Add to last commit","text":"<pre><code>git add &lt;stuff&gt;\ngit commit --amend\n&lt;keep or change commit message&gt;\n\n# may require remote force push\ngit push origin &lt;branch&gt; --force\n</code></pre>"},{"location":"git/#modify-last-n-commits","title":"Modify last N commits","text":"<pre><code># let's say you want to change the order or quantity of commits\n#  ranging from the most recent to 7 commits ago\ngit rebase -i HEAD~7\n\n# modify/reorder/delete commits using options provided\n#  i mostly use fixup and squash\n#  and reorder or delete commits\n</code></pre>"},{"location":"git/#trash-all-tracked-and-uncommitted-changes","title":"Trash all tracked (and uncommitted) changes","text":"<pre><code>git reset --hard\n</code></pre>"},{"location":"git/#trash-uncommitted-changes-for-a-single-tracked-file","title":"Trash uncommitted changes for a single tracked file","text":"<pre><code>git checkout HEAD -- path/to/file\n</code></pre>"},{"location":"git/#avoid-whitespace-issues","title":"Avoid whitespace issues","text":"<pre><code>git diff --check\n</code></pre>"},{"location":"git/#blaming","title":"Blaming","text":"<p>Basic <pre><code>git blame -L 24,48 mydir/myfile.py\n</code></pre></p> <p>Ignoring the impact of a commit (e.g. last commit was just formats) <pre><code>git blame --ignore-rev {commit-hash} -L 24,48 mydir/myfile.py\n</code></pre></p> <p>Ignoring the impact of lots of commits (via file) <pre><code>cat &lt;EOF &gt; .git-blame-ignore-revs\n# Applied black\n{commit-hash-full-40-char}\n\n# PEP8 updates\n{commit-hash-full-40-char}\nEOF\n\ngit blame --ignore-revs-file .git-blame-ignore-revs -L 24,48 mydir/myfile.py\n</code></pre></p> <p>Update git config with name of file to always use for ignores <pre><code>git config blame.ignoreRevsFile .git-blame-ignore-revs\ngit blame -L 24,48 mydir/myfile.py  # ignores specified changes\n</code></pre></p>"},{"location":"git/#important-links-and-practices","title":"Important Links and Practices","text":"<p>General: https://github.com/MikeMcQuaid/GitInPractice/blob/master/12-CreatingACleanHistory.adoc</p>"},{"location":"git/#use-gitflow","title":"Use gitflow","text":"<p>Gitflow is a branching and development practice which encourages project organization and release management.</p> <p>While I like the gitflow branching model, I do not like to rely on the obfuscation of the gitflow commands. Although requiring more keystrokes, I prefer to be hyper-aware of the component git commands which follow the gitflow branching model. Check out this gist for a comparison of the git equivalents of gitflow commands.</p>"},{"location":"git/#write-useful-commit-messages","title":"Write useful commit messages","text":"<p>Commit messages contain a lot of value if used well and written effectively. I strongly recommend reading Chris Beam's blog post about How to Write a Git Commit Message.</p>"},{"location":"git/#consult-git-in-practice","title":"Consult git in practice","text":"<p>A very thorough and practical approach to teaching in-depth git: GitInPractice.</p>"},{"location":"git/#bookmark-git-flight-rules","title":"Bookmark git flight rules","text":"<p>Sometimes things go wrong and you need to know how to dig yourself out of a hole. In these moments, consult git-flight-rules.</p>"},{"location":"git/#read-documentation","title":"Read documentation","text":"<p>When all else fails, or you have ample curiosity (and time), checkout the git manpages.</p>"},{"location":"git/#handling-multiple-git-identities","title":"Handling multiple git identities","text":"<p>Sometimes, you may need to support authentication to multiple git identities to the same SCM platform on the same system. Platforms, such as Github, do not allow you to associate the same ssh-key to multiple accounts. To get around this, you need to create multiple ssh-keys and follow a pattern such as \".gitconfig includes\" to handle when/where to use which ssh-key.</p> <p>See benji.dog/articles/git-config/ for extra info about includeIf for multi identify git</p>"},{"location":"jekyll/","title":"Jekyll","text":"<p>Requires Ruby to be installed</p> <pre><code># see local build with drafts\n$ bundle exec jekyll serve --drafts\n\n# update gems\n$ bundle update\n</code></pre>"},{"location":"mkdocs/","title":"Mkdocs","text":""},{"location":"mkdocs/#install","title":"Install","text":"<pre><code>pip install mkdocs\n</code></pre>"},{"location":"mkdocs/#default-project-structure","title":"Default Project Structure","text":"<pre><code>mkdocs.yml\ndocs/\n- index.md\n</code></pre>"},{"location":"mkdocs/#override-docs-directory","title":"Override Docs Directory","text":"<pre><code># mkdocs.yml\ndocs_dir: cheatsheets\n</code></pre>"},{"location":"mkdocs/#dev-server","title":"Dev Server","text":"<pre><code># in same dir as mkdocs.yml\nmkdocs serve\n\n# open http://127.0.0.1:8000/\n</code></pre>"},{"location":"mkdocs/#build-the-site","title":"Build the Site","text":"<pre><code>mkdocs build\n</code></pre>"},{"location":"mkdocs/#navigation-configuration","title":"Navigation Configuration","text":"<p>If specified, the navigation will present only that which is specified. <pre><code># mkdocs.yml\nnav:\n    - Home: index.md\n    - About: about.md\n</code></pre> If no navigation is provided, defaults to all contents inside of the <code>docs_dir</code> in alphanumeric order.</p>"},{"location":"python/","title":"Python","text":""},{"location":"python/#rounding","title":"Rounding","text":"<p>Weird behavior (when applying common school math terminology to programming): <pre><code>assert round(0.5) == 0\nassert round(1.5) == 2\n</code></pre></p> <p>Similar example, but rounding to nearest second in Pandas: <pre><code>from datetime import datetime\n\nimport pandas as pd\n\nd = [\n    {\"dt\": datetime(2023, 1, 1, 12, 30, 0, 500000), \"dt_up\": datetime(2023, 1, 1, 12, 30, 1)},\n    {\"dt\": datetime(2023, 1, 1, 12, 30, 1, 500000), \"dt_up\": datetime(2023, 1, 1, 12, 30, 2)},\n    {\"dt\": datetime(2023, 1, 1, 12, 30, 0, 500001), \"dt_up\": datetime(2023, 1, 1, 12, 30, 1)},\n    {\"dt\": datetime(2023, 1, 1, 12, 30, 1, 500001), \"dt_up\": datetime(2023, 1, 1, 12, 30, 2)},\n]\ndf = pd.DataFrame(d)\ndf[\"dt_rounded\"] = df[\"dt\"].dt.round(\"1S\")\ndf[\"is_correct\"] = df.apply(lambda x: x.dt_rounded == x.dt_up, axis=1)\nprint(df)\n\n\"\"\"\n                          dt               dt_up          dt_rounded  is_correct\n0 2023-01-01 12:30:00.500000 2023-01-01 12:30:01 2023-01-01 12:30:00       False\n1 2023-01-01 12:30:01.500000 2023-01-01 12:30:02 2023-01-01 12:30:02        True\n2 2023-01-01 12:30:00.500001 2023-01-01 12:30:01 2023-01-01 12:30:01        True\n3 2023-01-01 12:30:01.500001 2023-01-01 12:30:02 2023-01-01 12:30:02        True\n\"\"\"\n</code></pre></p> <p>Forcing rounding to nearest 1 second (in pandas) <pre><code>from datetime import datetime\n\nimport pandas as pd\n\n\ndef round_to_nearest_second(dt_val: pd.Series) -&gt; pd.Series:\n    \"\"\"\n    Perform accurate frequency rounding on a Pandas datetime series\n\n    Series.dt.round(freq) contains the caveat where values which are exactly in the middle of their upper and lower frequencies will\n    prioritize a resulting value which is even. This is the same caveat as Python's \"round()\".\n    e.g. round(0.5) == 0; round(1.5) == 2\n\n    For datetimes which are being rounded to the nearest 1 second, round(2023-04-10 16:06:12.500000) == 2023-04-10 16:06:12 whereas 12.500001 rounds to 13.\n\n    :param dt_val: datetime64[ns, utc] pandas series\n    :return: Series of rounded datetimes\n    \"\"\"\n    # https://pandas.pydata.org/docs/user_guide/timeseries.html#timeseries-offset-aliases\n    freq = \"1S\"\n    val = dt_val\n    if dt_val.microsecond &gt;= 500000:\n        val = dt_val.ceil(freq)\n    else:\n        val = dt_val.floor(freq)\n    return val\n\n\nd = [\n    {\"dt\": datetime(2023, 1, 1, 12, 30, 0, 500000), \"dt_up\": datetime(2023, 1, 1, 12, 30, 1)},\n    {\"dt\": datetime(2023, 1, 1, 12, 30, 1, 500000), \"dt_up\": datetime(2023, 1, 1, 12, 30, 2)},\n    {\"dt\": datetime(2023, 1, 1, 12, 30, 0, 500001), \"dt_up\": datetime(2023, 1, 1, 12, 30, 1)},\n    {\"dt\": datetime(2023, 1, 1, 12, 30, 1, 500001), \"dt_up\": datetime(2023, 1, 1, 12, 30, 2)},\n]\ndf = pd.DataFrame(d)\ndf[\"dt_rounded\"] = df[\"dt\"].apply(round_to_nearest_second)\ndf[\"is_correct\"] = df.apply(lambda x: x.dt_rounded == x.dt_up, axis=1)\nprint(df)\n\n\"\"\"\n                          dt               dt_up          dt_rounded  is_correct\n0 2023-01-01 12:30:00.500000 2023-01-01 12:30:01 2023-01-01 12:30:00        True\n1 2023-01-01 12:30:01.500000 2023-01-01 12:30:02 2023-01-01 12:30:02        True\n2 2023-01-01 12:30:00.500001 2023-01-01 12:30:01 2023-01-01 12:30:01        True\n3 2023-01-01 12:30:01.500001 2023-01-01 12:30:02 2023-01-01 12:30:02        True\n\"\"\"\n</code></pre></p> <p>Explanation:</p> <ul> <li>Python's <code>round()</code> function prioritizes numerically even-valued results when the value is equally between its multiples.<ul> <li>e.g. 0.5 is an equal distance between 0 and 1; thus 0 is prioritized.</li> <li>e.g. 1.5 is an equal distance between 1 and 2; thus 2 is prioritized.</li> </ul> </li> <li>Pandas' <code>Series.dt.round()</code> function uses the same behavior as Python's <code>round()</code>.</li> </ul> <p>This is not a Python bug. Read more from RealPython.</p>"},{"location":"ruby/","title":"Ruby","text":"<pre><code># install ruby version manager\ncurl -sSL https://get.rvm.io | bash -s stable\nrvm reload\n\n# install latest ruby\nrvm list known\nrvm install 3.0.0\n\n# check version\nruby -v\n\n# update bundler\nbundle update --bundler\n</code></pre>"},{"location":"sql/","title":"SQL","text":"<p>Style Guide * https://github.com/dlstadther/sql-style-guide/</p>"},{"location":"sql/#order-of-operations","title":"Order of Operations","text":"Operation Description from source locations to get base data where filters base data group by aggregates base data having filters aggregated data select returns final data order by sorts final data limit reduces final data to a row count"},{"location":"sql/#general","title":"General","text":""},{"location":"sql/#create-daily-or-dom-snapshots-of-change-data","title":"Create daily (or DOM) snapshots of change data","text":"<p>Given a dataset which generates at a non-daily rate, create a view which displays the state as of each end-of-month (EOM) date.</p> <p>Use of <code>generate_series()</code> is specific to postgres and various sql dialects may or may not have similar functionality.</p> <pre><code>with\n-- list of all dates between range\nstatic_dates as (\n    SELECT date_trunc('day', dd):: date as the_date\n    FROM generate_series\n             ( '2022-01-01'::timestamp\n             , '2022-08-31'::timestamp\n             , '1 day'::interval) dd\n)\n-- list of EOM dates from \"static_dates\"\n, eom_dates as (\n    select cast(the_date - interval '1 day' as date) as the_date from static_dates where extract('day' from the_date) = 1\n)\n-- fake data to mock a dataset which exists multi-times per month, or missing months\n, data as (\n    select 'abc123' as client_id, 'x' as row_id, '1' as val, cast('2022-03-01' as date) as exec_date union all -- Mar, Apr\n    select 'abc123' as client_id, 'y' as row_id, '2' as val, cast('2022-05-01' as date) as exec_date union all -- none\n    select 'abc123' as client_id, 'z' as row_id, '3' as val, cast('2022-05-02' as date) as exec_date union all -- May\n    select 'abc123' as client_id, 'a' as row_id, '4' as val, cast('2022-06-30' as date) as exec_date           -- Jun\n)\n-- create date range for when \"data\" rows are relevant\n, data_range as (\n    select\n        client_id, row_id, val, exec_date\n        , lead(exec_date) over(partition by client_id order by exec_date asc) as next_date\n    from\n        data\n)\n-- ensure that all \"data_range\" rows include a \"next_date\" (the last record per id will have a null \"next_date\")\n, data_range_notnull as (\n    select\n        client_id, row_id, val, exec_date,\n        case when next_date is null then current_date else next_date end as next_date\n    from\n        data_range\n)\n-- join data range to all dates between \"exec_date\" and \"next_date\"\n-- filter to only EOM dates\nselect\n    *\nfrom\n    data_range_notnull as d\nleft join\n    static_dates as sd\non\n    d.exec_date &lt;= sd.the_date\n    and d.next_date &gt; sd.the_date\nwhere\n    sd.the_date in (select the_date from eom_dates)\n</code></pre>"},{"location":"system76/","title":"System76","text":"<p>Firmware Update for Custom Keymap <pre><code># clone fork of embedded controller code\ngit clone git@github.com:dlstadther/ec.git\n\n# checkout custom keymap\ncd ec\ngit fetch origin\ngit checkout ds\n\n# install build dependencies\n./scripts/deps.sh\n\n# prepare firmware with custom keymap\nmake BOARD=system76/lemp9 KEYMAP=dillon\n\n# flash firmware, using bugfix command\n# ref: https://github.com/system76/ec/issues/185#issuecomment-846033330\nPKG_CONFIG_PATH=/usr/lib/x86_64-linux-gnu/pkgconfig/ make flash_internal\n\n\n# system76 generic instructions:\n# https://github.com/system76/ec/blob/master/doc/keyboard-layout-customization.md\n</code></pre></p>"},{"location":"uv/","title":"UV","text":"<p>UV markets its self as \"an extremely fast Python package and project manager, written in Rust\".</p> <p>As a project dependency manager and build tool, it's similar to Poetry.</p> <p>Docs</p> <p>Sample Conversion from Poetry to UV (0.3.2): github.com/dlstadther/sample-project-python/pull/5</p> <p>Migration script to convert Poetry or Pipenv projects to UV: mkniewallner/migrate-to-uv</p>"},{"location":"uv/#install","title":"Install","text":"<pre><code># latest\ncurl -LsSf https://astral.sh/uv/install.sh | sh\n\n# specific version\ncurl -LsSf https://astral.sh/uv/0.3.0/install.sh | sh\n</code></pre>"},{"location":"uv/#upgrade","title":"Upgrade","text":"<pre><code>uv self update\n</code></pre>"},{"location":"uv/#installing-python","title":"Installing Python","text":"<pre><code># view available and installed python versions\nuv python list\n\n# install latest patch version if major.minor version is not already installed\n# (e.g. if 3.12.7 is installed, 3.12.8 won't be installed)\nuv python install 3.12\n# install a specific version\nuv python install 3.12.8\n</code></pre>"},{"location":"uv/#use-within-project","title":"Use within Project","text":"<pre><code># initialize new project not yet created\nuv init project-name\n\n# initialize existing directory\ncd project-name\nuv init\n\n# build project\nuv build\n# build project with single format\nuv build sdist\nuv build wheel\n\n# publish project (assumes token set at UV_PUBLISH_TOKEN)\nuv publish\n\n# increment version (assuming Hatch is the build backend)\nuvx hatch version patch\nuvx hatch version minor\nuvx hatch version major\nuvx hatch version minor,rc\n</code></pre> <p><code>uv init</code> can be used within existing python projects, unless a <code>pyproject.toml</code> file has already been created using an alternative package manager (e.g. <code>poetry</code>)</p>"},{"location":"uv/#manage-tools-outside-of-projects","title":"Manage Tools (outside of projects)","text":"<pre><code># temporary use\nuvx ruff format\n\n# installing tool for persistent access\nuv tool install ruff\n# use installed tool\nruff --version\n\n# upgrade installed tool\nuv tool upgrade ruff\n</code></pre>"},{"location":"windows/","title":"Windows","text":"<p>Invert Mouse Scroll Wheel (for all mice devices attached) (1 == inverted) Run as Administrator, then restart computer <pre><code>$mode = Read-host \"How do you like your mouse scroll (0 or 1)?\"; Get-PnpDevice -Class Mouse -PresentOnly -Status OK | ForEach-Object { \"$($_.Name): $($_.DeviceID)\"; Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Enum\\$($_.DeviceID)\\Device Parameters\" -Name FlipFlopWheel -Value $mode; \"+--- Value of FlipFlopWheel is set to \" + (Get-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Enum\\$($_.DeviceID)\\Device Parameters\").FlipFlopWheel + \"`n\" }\n</code></pre></p>"}]}